<!--
  @description       : 
  @author            : Hyerin Ro
  @group             : 
  @last modified on  : 2025-05-07
  @last modified by  : yeongju.yun
  Modifications Log
  Ver   Date         Author      Modification
  1.0   11-14-2024   Hyerin Ro   Initial Version
-->
<aura:component controller="DN_QuoteItemAccessoryController">

    <aura:attribute name="isLoading" type="Boolean" default="false" />
    <aura:attribute name="checkDNSA" type="Boolean" default="false" />
    <aura:attribute name="checkDomestic" type="Boolean" default="false" />

    <aura:attribute name="selectedItems" type="List" description="Selected Quote Lineitem" />

    <aura:attribute name="selTableColumns" type="List" description="Selected Table Columns" />
    <aura:attribute name="selTableData" type="List" description="Selected Table Data" />
    <aura:attribute name="delTableData" type="List" description="Deleted Table Data" />
    <aura:attribute name="defaultData" type="List" description="Default Table Data" />

    <aura:attribute name="quoteId" type="String" />
    <aura:attribute name="category" type="String" description="Category (combobox) value" />
    <aura:attribute name="categoryOption" type="List" description="Category (combobox) option" />
    <aura:attribute name="categoryOptionData" type="List" description="All data not selected" />

    <aura:attribute name="tableColumns" type="List" description="Table Columns" />
    <aura:attribute name="tableData" type="List" description="Table Data" />
    <aura:attribute name="draftValues" type="Object" default="[]"/>
    <lightning:overlayLibrary aura:id="overlayLib" />

    <aura:handler name="init" value="{!this}" action="{!c.doinit}" />

    <aura:html tag="style">
        .slds-modal__container:has(.cDN_QuoteItemAccessoryModal){
            width: 50rem;
            max-width: calc(100vw - 8rem);
            margin: 0 auto;
            max-height: 68rem;
            top: 50%;
            transform: translateY(-50%);
            padding: 4rem 0 3rem 0;
        }

        .slds-modal__content:has(.cDN_QuoteItemAccessoryModal){
            padding: 0;
            height: 100%;
            overflow: hidden;
        }

        @media all and (max-width: 479px) {
            .slds-modal__container:has(.cDN_QuoteItemAccessoryModal){
                max-width: calc(100vw - 2rem);
            }
        }
    </aura:html>

    <div>
        <aura:if isTrue="{!v.isLoading}">
            <div class="SpinnerDiv">
                <lightning:spinner alternativeText="Loading" size="medium" />
            </div>
        </aura:if>

        <div class="slds-modal__container">
            <div class="slds-modal__content slds-p-around_small">

                <!-- Section 01 -->
                <div class="catecory_section">
                    <aura:if isTrue="{!v.checkDNSA}">
                        <div class="category_combobox">
                            <lightning:combobox label="Category" variant="label-inline" options="{!v.categoryOption}"
                                value="{!v.category}" onchange="{!c.handleCategoryChange}" />
                        </div>
                    </aura:if>
                    <div>
                        <lightning:button variant="neutral" label="{!$Label.c.DNS_B_Cancel}"
                            onclick="{!c.handleClose}" />
                        <lightning:button variant="brand" label="{!$Label.c.DNS_B_Save}" onclick="{!c.handleSave}" />
                    </div>
                </div>

                <!-- Section 02 -->
                <div class="accessory_table_section">
                    <lightning:datatable 
                        keyField="key" 
                        columns="{!v.tableColumns}" 
                        data="{!v.tableData}"
                        hideCheckboxColumn="true" 
                        onrowaction="{!c.handleRowAction}"
                        onrowselection="{!c.handleRowSelection}" />
                </div>

                <!-- Section 03 -->
                <div class="down_icon_section">
                    <lightning:icon iconName="utility:down" title="selected" size="small" />
                </div>
                
                <!-- Section 04 -->
                <div class="selected_table_section">
                    <div class="section-header">
                        <div class="icon-wrap">
                            <lightning:icon iconName='standard:multi_select_checkbox' size='x-small' title="{!$Label.c.DNS_S_SelectedList}" />
                        </div>
                        <h1 class="slds-page-header__name-title" title="{!$Label.c.DNS_S_SelectedList}">{!$Label.c.DNS_S_SelectedList}</h1>
                    </div>
                    <lightning:datatable 
                        keyField="key" 
                        columns="{!v.selTableColumns}" 
                        data="{!v.selTableData}"
                        hideTableHeader="true" 
                        hideCheckboxColumn="true" 
                        draftValues="{! v.draftValues }"
                        onrowaction="{!c.handleRowAction}"
                        onrowselection="{!c.handleSelRowSelection}" 
                        oncellchange="{!c.handleCellChange}"
                        suppressBottomBar="true"/>
                </div>

            </div>
        </div>
    </div>

</aura:component>