<!--
  @description       : 
  @author            : youjin.shim@sbtglobal.com
  @group             : 
  @last modified on  : 01-10-2025
  @last modified by  : youjin.shim@sbtglobal.com
  Modifications Log
  Ver   Date         Author                      Modification
  1.0   01-10-2025   youjin.shim@sbtglobal.com   Initial Version
-->
<aura:component
  implements="forceCommunity:availableForAllPageTypes,force:lightningquickactionwithoutheader,force:appHostable,flexipage:availableForAllPageTypes,flexipage:availableForRecordHome,force:hasRecordId,force:hasSObjectName,force:lightningQuickAction,lightning:isUrlAddressable,lightning:actionOverride,lightning:hasPageReference,lightning:availableForFlowScreens"
  description="ÎåÄÎ¶¨Ï†êÍ∞Ñ Í±∞ÎûòÏäπÏù∏ Î∞è ÏàòÏ†ï"
  controller="DN_CreateAnotherAgencyPurchase"
  extends="c:DN_Helper">

  <!--Attribute-->
  <aura:attribute name="isLoading" type="Boolean" default="false" />
  <aura:attribute name="dealerPurchaseOrder" type="Object" default="{}" description="Ï£ºÎ¨∏Ï†ïÎ≥¥"/>
  <aura:attribute name="partsList" type="List" description="ÎåÄÎ¶¨Ï†êÍ∞Ñ Ï£ºÎ¨∏ ÌíàÎ™©" />
  
  <aura:attribute name="dealRequestManagement" type="Boolean" default="false" />

  <aura:attribute name="dealerList" type="List" default="[]" />
  <aura:attribute name="popupList" type="List" default="[]" />
  <aura:attribute name="deliveryCategory" type="List" default="[
        {'label':'Î∞©Î¨∏ÏàòÎ†π', 'value' : '4'},
        {'label':'ÌÉùÎ∞∞', 'value' : '1'},
        {'label':'ÌôîÎ¨º', 'value' : '2'},
        {'label':'ÌÄµÏÑúÎπÑÏä§', 'value' : '3'}
    ]" />
  <aura:attribute name="bulkShippingOptions" type="List" default="[
    {'label': 'Yes', 'value': 'Y'},
    {'label': 'No', 'value': 'N'}
  ]" />
  <aura:attribute name="approvalStatus" type="Boolean" default="true" />
  <aura:attribute name="approvalList" type="List" default="[]" />

  <!-- Navigation -->
  <lightning:navigation aura:id="navService"/>

  <!--handler-->
  <aura:handler name="init" value="{! this }" action="{! c.doInit }" />
  <article class="slds-card">
    <!-- üìå 1. ÎåÄÎ¶¨Ï†êÍ∞Ñ Í±∞Îûò ÏöîÏ≤≠ Í¥ÄÎ¶¨ Î™®Îã¨ ÏÇ¨Ïö© x-->
    <!-- <aura:if isTrue="{!v.dealRequestManagement}">
      <div class="card-01 top-card">
        <div class="slds-scrollable">
          <table class="slds-table slds-table_cell-buffer slds-table_col-bordered IP-table">
            <colgroup>
              <col width="18%" />
              <col width="18%" />
              <col width="14%" />
              <col width="10%" />
              <col width="10%" />
              <col width="10%" />
              <col width="10%" />
              <col width="10%" />
            </colgroup>
            <thead>
              <tr>
                <th>
                  <div>Íµ¨Îß§ÎåÄÎ¶¨Ï†ê</div>
                </th>
                <th>
                  <div>Íµ¨Îß§Ï£ºÎ¨∏Î≤àÌò∏</div>
                </th>
                <th>
                  <div>Ï£ºÎ¨∏Î≤àÌò∏</div>
                </th>
                <th>
                  <div>Ï£ºÎ¨∏Ïùº</div>
                </th>
                <th>
                  <div>Ï£ºÎ¨∏ÏàòÎüâ</div>
                </th>
                <th>
                  <div>Íµ¨Îß§Í∏àÏï°</div>
                </th>
                <th>
                  <div>ÌÜµÌôî</div>
                </th>
                <th>
                  <div>ÏÉÅÌÉú</div>
                </th>
              </tr>
            </thead>
            <tbody>
              <aura:if isTrue="{!empty(v.popupList)}">
                <tr class="slds-hint-parent">
                  <td scope="row" colspan="9" style="text-align: center;">
                    Ï°∞ÌöåÎêú Ï†ïÎ≥¥Í∞Ä ÏóÜÏäµÎãàÎã§
                  </td>
                </tr>
              </aura:if>
              <aura:iteration items="{!v.popupList}" var="popupList" indexVar="j">
                <tr>
                  <td>
                    <div>{!popupList.NAME1}</div>
                  </td>
                  <td>
                    <div>{!popupList.EBELN}</div>
                  </td>
                  <td>
                    <div>{!popupList.VBELN}</div>
                  </td>
                  <td class="center">
                    <div>{!popupList.AUDAT}</div>
                  </td>
                  <td>
                    <div>{!popupList.MENGE}</div>
                  </td>
                  <td>
                    <div class="right">{!popupList.DMBTR}</div>
                  </td>
                  <td>
                    <div>{!popupList.WAERS}</div>
                  </td>
                  <td>
                    <div>{!popupList.STEXT}</div>
                  </td>
                </tr>
              </aura:iteration>
            </tbody>
          </table>
        </div>
      </div>
    </aura:if> -->
  
    <!-- üìå 2. ÎåÄÎ¶¨Ï†êÍ∞Ñ Í±∞Îûò ÏäπÏù∏ Í¥ÄÎ¶¨ Î™®Îã¨ -->
    <aura:if isTrue="{!v.approvalStatus}">
      
      <header class="header">
        <div class="title">
          <lightning:icon iconName='standard:custody_chain_entry' size='small' title='custody_chain_entry'></lightning:icon>
          <h2 class="">ÎåÄÎ¶¨Ï†êÍ∞Ñ Í±∞ÎûòÏäπÏù∏ Í¥ÄÎ¶¨</h2>
        </div>
  
        <div class="button-wrap">
            <lightning:button iconName="utility:check" label="ÏäπÏù∏" onclick="{!c.approval}" />
            <lightning:button iconName="utility:error" label="Í±∞Ï†à" onclick="{!c.reject}" />
        </div>
      </header>
      
      <div class="body">
         <!-- Card 01 -->
         <div class="card-01 top-card">
          <div class="field-wrap">
            <p>Í≥†Í∞ùÏ£ºÎ¨∏Î≤àÌò∏</p>
            <div class="input-wrap">
              <lightning:input variant="label-hidden" readonly="true" value="{!v.dealerPurchaseOrder.seq}"/>
            </div>
          </div>
          <div class="field-wrap">
            <p>Ï£ºÎ¨∏Î≤àÌò∏</p>
            <div class="input-wrap">
              <lightning:input variant="label-hidden" readonly="true" value="{!v.dealerPurchaseOrder.dealerOrderSeq}"/>
            </div>
          </div>
          <div class="field-wrap">
            <p>ÏÉùÏÑ±ÏùºÏûê</p>
            <div class="input-wrap">
              <lightning:input variant="label-hidden" readonly="true" value="{!v.dealerPurchaseOrder.orderDate}"/>
            </div>
          </div>
          <div class="field-wrap">
            <p>Íµ¨Îß§ÎåÄÎ¶¨Ï†ê</p>
            <div class="input-wrap">
              <lightning:input variant="label-hidden" readonly="true" value="{!v.dealerPurchaseOrder.dealerName}"/>
            </div>
          </div>
          <div class="field-wrap">
            <p>ÏùºÍ¥ÑÎ∞∞ÏÜ°Ïó¨Î∂Ä</p>
            <div class="input-wrap">
              <lightning:radioGroup variant="label-hidden" aura:id="batchDelivery" options="{! v.bulkShippingOptions }"
                disabled="true" value="{!v.dealerPurchaseOrder.bulkShipping}"/>
            </div>
          </div>
          <div class="field-wrap">
            <p>Î∞∞ÏÜ° Î∞©Î≤ï</p>
            <div class="input-wrap">
              <lightning:combobox variant="label-hidden" label="Î∞∞ÏÜ° Î∞©Î≤ï" readonly="true" options="{!v.deliveryCategory}" value="{!v.dealerPurchaseOrder.shippingType}"/>
              <!-- <lightning:input variant="label-hidden" readonly="true" value="{!v.dealerPurchaseOrder.shippingType}"/> -->
            </div>
          </div>
          <div class="field-wrap">
            <p>Î∞∞ÏÜ°Ï≤ò</p>
            <div class="input-wrap">
              <lightning:input variant="label-hidden" readonly="true" value="{!v.dealerPurchaseOrder.customerShipToName}"/>
            </div>
          </div>
        </div>
  
        <!-- card-02 -->
        <div class="card-02 top-card">
          <div class="table-wrap">
            <!-- Fixed : Left -->
            <div class="table-01 left-table" aura:id="leftTableDiv">
              <table class="slds-table slds-table_cell-buffer slds-table_col-bordered IP-table">
                <colgroup>
                  <col width="1%" />
                  <col width="25%" />
                  <col width="75%" />
                </colgroup>
                <thead>
                  <tr class="slds-line-height_reset">
                    <th>
                      <div>
                        <lightning:input type="checkbox" variant="label-hidden" onchange="{!c.selectAll}" />
                      </div>
                    </th>
                    <th>
                      <div>Ìï≠Î™©</div>
                    </th>
                    <th>
                      <div>Ï£ºÎ¨∏ÌíàÎ≤à</div>
                    </th>
                  </tr>
                </thead>
                <tbody>
                  <aura:iteration items="{!v.partsList}" var="parts" indexVar="k">
                    <tr class="slds-hint-parent">
                      <td data-label="checkbox" class="center">
                        <div title="checkbox">
                          <lightning:input type="checkbox" checked="{!parts.isSelected}" variant="label-hidden"  />
                          <!-- disabled="{!parts.isDisabledChange}" -->
                        </div>
                      </td>
                      <td data-label="Ìï≠Î™©" class="center">
                        {!parts.itemSeq}
                      </td>
                      <td data-label="Ï£ºÎ¨∏ÌíàÎ≤à" class="center">
                        {!parts.replacingPartName}
                      </td>
                    </tr>
                  </aura:iteration>
                </tbody>
              </table>
            </div>
            <!-- Scrollable : Right -->
            <div class="table-02 right-table" aura:id="rightTableDiv" onscroll="{!c.handleScroll}">
              <table class="slds-table slds-table_cell-buffer   slds-table_col-bordered IP-table">
                <colgroup>
                  <col width="6%" />
                  <col width="6%" />
                  <col width="8%" />
                  <col width="8%" />
                  <col width="5%" />
                  <col width="6%" />
                  <col width="8%" />
                  <col width="15%" />
                  <col width="15%" />
                  <col width="15%" />
                  <col width="8%" />
                </colgroup>
                <thead>
                  <tr class="slds-line-height_reset">
                    <th>
                      <div>ÌíàÎ™Ö</div>
                    </th>
                    <th>
                      <div>
                        ÏöîÏ≤≠ÏàòÎüâ
                        <!-- ÏàòÎüâ(A) -->
                      </div>
                    </th>
                    <th>
                      <div>Ï∂úÍ≥†ÏàòÎüâ</div>
                    </th>
                    <th>
                      <div>ÎØ∏Í≤∞ÏàòÎüâ</div>
                    </th>
                    <th>
                      <div>ÎåÄÎ¶¨Ï†êÏû¨Í≥†</div>
                    </th>
                    <th>
                      <div>Îã®ÏúÑ</div>
                    </th>
                    <th>
                      <div>ÌÜµÌôî</div>
                    </th>
                    <th>
                      <div>Í≥†Í∞ùÌåêÎß§Í∞Ä</div>
                    </th>
                    <th>
                      <div>Ìï†Ïù∏ÌåêÎß§Í∞Ä</div>
                    </th>
                    <th>
                      <div>Ìï†Ïù∏ÌåêÎß§Í∏àÏï°</div>
                    </th>
                    <th>
                      <div>ÏµúÏ¢ÖÏöîÏ≤≠ÏàòÎüâ</div>
                    </th>
                    <!-- <th>
                      <div>ÏÉÅÌÉú</div>
                    </th> -->
                  </tr>
                </thead>
                <tbody>
                  <aura:iteration items="{!v.partsList}" var="parts" indexVar="k">
                    <tr class="slds-hint-parent">
                      <td data-label="ÌíàÎ™Ö">
                        {!parts.partDetails}
                      </td>
                      <td data-label="ÏöîÏ≤≠ÏàòÎüâ" class="center">
                        <lightning:formattedNumber value="{!parts.quantity}" />
                      </td>
                      <td data-label="Ï∂úÍ≥†ÏàòÎüâ" class="right">
                        <!-- <lightning:input type="number" aura:id="" name="giQuantity" variant="label-hidden" readonly="true" value="{!parts.giQuantity}" /> -->
                        <lightning:formattedNumber value="{!parts.giQuantity}" />
                      </td>
                      <td data-label="ÎØ∏Í≤∞ÏàòÎüâ" class="right">
                        {!IF(parts.giQuantity==0, 0,parts.giQuantity - parts.quantity)}
                      </td>
                      <td data-label="ÎåÄÎ¶¨Ï†êÏû¨Í≥†" class="right">
                        <!-- ÎåÄÎ¶¨Ï†êÍ∞ÄÏö©Ïû¨Í≥† -->
                        <lightning:formattedNumber value="{!parts.avaiableQuantity}" />
                      </td>
                      <td data-label="Îã®ÏúÑ" class="center">
                        {!parts.unit}
                      </td>
                      <td data-label="ÌÜµÌôî" class="center">
                        {!parts.currencyCode}
                      </td>
                      <td data-label="Í≥†Í∞ùÌåêÎß§Í∞Ä" class="right">
                        <!-- <lightning:input type="number" aura:id="" name="customerPrice" variant="label-hidden" readonly="true" value="{!parts.customerPrice}" /> -->
                        <lightning:formattedNumber value="{!parts.customerPrice}" />
                      </td>
                      <td data-label="Ìï†Ïù∏ÌåêÎß§Í∞Ä" class="right">
                        <!-- <lightning:input type="number" aura:id="" name="discountPrice" variant="label-hidden" readonly="true" value="{!parts.discountPrice}" /> -->
                        <lightning:formattedNumber value="{!parts.discountPrice}" />
                      </td>
                      <td data-label="Ìï†Ïù∏ÌåêÎß§Í∏àÏï°" class="right">
                        <!-- <lightning:input type="number" aura:id="" name="discountAmount" variant="label-hidden" readonly="true" value="{!parts.discountAmount}" /> -->
                        <lightning:formattedNumber value="{!parts.discountAmount}" />
                      </td>
                      <td data-label="ÏµúÏ¢ÖÏöîÏ≤≠ÏàòÎüâ" class="right">
                        <lightning:formattedNumber value="{!parts.finalChangeQuantity}" />
                      </td>
                    </tr>
                  </aura:iteration>
                </tbody>
              </table>
            </div>
          </div>
        </div> 
      </div>
    </aura:if>

  </article>
</aura:component>