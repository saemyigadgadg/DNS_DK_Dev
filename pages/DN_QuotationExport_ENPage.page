<!--
  @description       : 
  @author            : Hyerin Ro
  @group             : 
  @last modified on  : 03-04-2025
  @last modified by  : Hyerin Ro
  Modifications Log
  Ver   Date         Author      Modification
  1.0   07-17-2024   Hyerin Ro   Initial Version
-->
<apex:page standardController="Quote" 
            extensions="DN_QuotationPDFController"
            showQuickActionVfHeader="false" 
            showHeader="false" 
            standardStylesheets="false" 
            sidebar="false"   
            contentType="text/html;charset=UTF-8"
            applyHtmlTag="false"        
              
            >
<!-- renderAs="pdf" -->
<!-- applyHtmlTag="false" -->

    <html>

        <head>
            <meta charset="UTF-8" />        
            <!-- <apex:stylesheet value="{!URLFOR($Resource.DN_Logo_Global, 'DN_Logo_Global.png')}" /> -->
            <style >

                /* Common */
                body {
                     font-family: Arial Unicode MS, sans-serif;
                     font-weight: 400;
                     /* font-size: 12px; */
                     line-height: 140%;
                    padding: 3rem;
               }    
                th, td, dd, dt{
                    font-size: 13px;
                }            
                /* Header */
                .header table{
                    border: none;
                }
                .header td{
                    padding: 0;
                    border: none;
                }
                h1{
                  font-size: 18px;
                  font-weight: 500;
                  text-align: center;
                  text-decoration: underline;
                  margin: 0;
                }

                /* Table  */
                table, td, th{
                    border : 0.5px solid black;
                    border-collapse : collapse !important;
                }
                table{
                    width: 100%;
                    border-spacing: 0;
                    margin-bottom: 12px;
                }     
                table th{
                    padding: 5px;
                    font-weight: 400;
                }             
                table td{
                    padding: 5px;
                }      
                .table-01 th, .table-02 th{
                    text-align: left;
                }
                table .td-02 td{
                  height: 300px;
                }
                /* .table-03,
                .table-03 th,
                .table-03 td {
                    border : 0.5px solid black;
                    border-collapse : collapse !important;
                } */
                .table-03 table th{
                  text-align: center;
                  background-color: #EEF4FF;
                }
                table tfoot td{
                  text-align: center;
                }
                table tfoot .colored td {
                  background-color: #EEF4FF;
                }   

                .right{text-align:right;}

                /* 페이지 구분을 위한 점선 */
                .page-break-line {
                    border-top: 1px dashed #000;
                    margin: 20px 0;
                    display: none;
                }

                /* 화면에서만 점선 표시 */
                @media screen {
                    .page-break-line {
                        display: block;
                    }
                }

                /* PDF에서는 점선 숨김 */
                @media print {
                    .page-break-line {
                        display: none;
                    }
                }

                /* 화면에서만 header 표시 */
                @media screen {
                    .isPage {
                        display: none;
                    }
                }

                /* PDF에서는 header 숨김 */
                @media print {
                    .isPage {
                        display: table-row;
                        /* display: none; */
                        page-break-before: always;
                    }
                }
                @page {
                    @bottom-center {
                        content: "Page " counter(page) " of " counter(pages);
                    }
                }
            </style>
        </head>
        <body>
        <apex:repeat value="{!result['QuoteLineItems']}" var="item">
        
            <div class="header">
                <table>
                    <colgroup>
                        <col width="33%" />
                        <col width="34%" />
                        <col width="33%" />
                    </colgroup>
                    <tr>
                        <td></td>
                        <td><h1>Quotation Sheet</h1></td>
                        <td class="right">
                            <div>
                                <apex:image url="{!$Resource.DN_Logo_Global}" width="180" height="30"/>
                            </div>
                        </td>
                    </tr>
                </table>
            </div>

            <div class="table-01">
                <table>
                    <colgroup>
                        <col width="15%" />
                        <col width="20%" />
                        <col width="10%" />
                        <col width="21%" />
                        <col width="10%" />
                        <col width="20%" />
                      </colgroup>

                    <tbody>
                        <tr>
                            <th>Dealer</th>
                            <td colspan="3">{!result['Dealer']}</td>
                            <th>Date</th>
                            <td>{!result['CreatedDate']}</td>
                        </tr>
                        <tr>
                            <th>Customer</th>
                            <td colspan="4">{!result['AccountName']}</td>
                            <td>{!result['NewExist']}</td>
                        </tr>
                        <tr>
                            <th>Address</th>
                            <td colspan="5">{!result['Address']}</td>
                        </tr>
                        <tr>
                            <th>Representative</th>
                            <td>{!result['Representative']}</td>
                            <th>Industry</th>
                            <td>{!result['Industry']}</td>
                            <th>Port</th>
                            <td>{!result['Port']}</td>
                        </tr>
                        <tr>
                            <th>Incoterms</th>
                            <td>{!result['Incoterms']}</td>
                            <th>Payment</th>
                            <td>{!result['TermsOfPayment']}</td>
                            <td colspan="2">{!result['ProductType']}</td>
                        </tr>
                        <tr>
                            <th>
                                Existing machine <br /> (Brand/model/Qty)
                            </th>
                            <td colspan="5">{!result['ExMachine']}</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="table-02">
                <table>
                  <colgroup>
                     <col width="15%" />
                     <col width="85%" />
                  </colgroup>
                    <tbody>
                        <tr>
                            <th>Purpose of Use</th>
                            <td>{!result['PurposeofUse']}</td>
                        </tr>
                        <tr>
                            <th>Usage of Product</th>
                            <td>{!result['UsageofProduct']}</td>
                        </tr>
                        <tr>
                            <th>Pre-Inspection</th>
                            <td>{!result['PreInspection']}</td>
                        </tr>
                        <tr>
                            <th>Competition <br /> (Brand/model/Qty)</th>
                            <td>{!result['Competition']}</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="table-03">
                <table style="-Fs-table-paginate: paginate">
                  <colgroup>
                     <col width="3%" />
                     <col width="40%" />
                     <col width="13%" />
                     <col width="4%" />
                     <col width="20%" />
                     <col width="20%" />
                   </colgroup>
                   <thead>
                        <tr>
                            <th>No</th>
                            <th>Description</th>
                            <th>RDD</th>
                            <th>Qty</th>
                            <th>Unit Price ({!result['Currency']})</th>
                            <th>Amount ({!result['Currency']})</th>
                        </tr>
                    </thead>
                    <tbody>                        
                        <tr>
                            <td colspan="2" style="text-align : center;">Machine Model / Controller</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>{!item['ProductName']}</td>
                            <td>{!item['RDD']}</td>
                            <td>{!item['Quantity']}</td>
                            <td>{!item['ListPrice']}</td>
                            <td>{!item['prdTotal']}</td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>-</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                        <tr>
                            <td colspan="2" style="text-align : center;">Option</td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>

                        <apex:repeat value="{!item['CharacteristicValues']}" var="charValue">
                            <!-- <apex:outputPanel rendered="{!charValue['isPage']}"> -->
                                <!-- <div class="isPage" style="page-break-before: always;"></div> -->
                                <!-- <thead class="isPage"> -->
                                    <!-- <tr class="isPage" style="{!IF(charValue['isPage'] == false, 'display: none;', '')}">
                                        <th style="background: yellow;">
                                            <apex:outputPanel rendered="{!charValue['isPage']}">No</apex:outputPanel>
                                        </th>
                                        <th style="background: yellow;">
                                            <apex:outputPanel rendered="{!charValue['isPage']}">Description</apex:outputPanel>
                                        </th>
                                        <th style="background: yellow;">
                                            <apex:outputPanel rendered="{!charValue['isPage']}">RDD</apex:outputPanel>
                                        </th>
                                        <th style="background: yellow;">
                                            <apex:outputPanel rendered="{!charValue['isPage']}">Qty</apex:outputPanel>
                                        </th>
                                        <th style="background: yellow;">
                                            <apex:outputPanel rendered="{!charValue['isPage']}">Dealer Price</apex:outputPanel>
                                        </th>
                                        <th style="background: yellow;">
                                            <apex:outputPanel rendered="{!charValue['isPage']}">Amount</apex:outputPanel>
                                        </th>
                                    </tr> -->
                                <!-- </thead> -->
                            <!-- </apex:outputPanel> -->
                            <!-- <apex:outputPanel rendered="{!charValue['Character'] == 'SQ' || charValue['Character'] == 'Accessory'}"> -->
                                    <tr style="{!IF(charValue['Character'] != 'SQ' && charValue['Character'] != 'Accessory', 'display: none;', '')}">
                                        <td colspan="2" style="text-align : center;">
                                            <apex:outputPanel rendered="{!charValue['Character'] == 'SQ' || charValue['Character'] == 'Accessory'}">{!charValue['Character']} </apex:outputPanel>
                                        </td>
                                        <td>
                                            <!-- <apex:outputPanel rendered="{!charValue['Character'] == 'SQ' || charValue['Character'] == 'Accessory'}"></apex:outputPanel> -->
                                        </td>
                                        <td>
                                            <apex:outputPanel rendered="{!charValue['Character'] == 'SQ' || charValue['Character'] == 'Accessory'}">{!charValue['cvQty']}</apex:outputPanel>
                                        </td>
                                        <td>
                                            <apex:outputPanel rendered="{!charValue['Character'] == 'SQ' || charValue['Character'] == 'Accessory'}">{!charValue['Price']}</apex:outputPanel>
                                        </td>
                                        <td>
                                            <apex:outputPanel rendered="{!charValue['Character'] == 'SQ' || charValue['Character'] == 'Accessory'}">{!charValue['cvTotal']}</apex:outputPanel>
                                        </td>
                                    </tr>
                                <!-- </apex:outputPanel> -->
                                <!-- <apex:outputPanel rendered="{!charValue['Character'] != 'SQ' && charValue['Character'] != 'Accessory'}"> -->
                                    <tr style="{!IF(charValue['Character'] == 'SQ' || charValue['Character'] == 'Accessory', 'display: none;', '')}">
                                        <td>
                                            <apex:outputPanel rendered="{!charValue['Character'] != 'SQ' && charValue['Character'] != 'Accessory'}">{!charValue['No']}</apex:outputPanel>
                                        </td>
                                        <!-- <td>{!charValue['Character']} - {!charValue['Value']}</td> -->
                                        <td>
                                            <apex:outputPanel rendered="{!charValue['Character'] != 'SQ' && charValue['Character'] != 'Accessory'}">{!charValue['Character']}&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{!charValue['Descrip']}</apex:outputPanel>
                                        </td>
                                        <td>
                                            <!-- <apex:outputPanel rendered="{!charValue['Character'] != 'SQ' && charValue['Character'] != 'Accessory'}"></apex:outputPanel> -->
                                        </td>
                                        <td>
                                            <apex:outputPanel rendered="{!charValue['Character'] != 'SQ' && charValue['Character'] != 'Accessory'}">{!charValue['cvQty']}</apex:outputPanel>
                                        </td>
                                        <td>
                                            <apex:outputPanel rendered="{!charValue['Character'] != 'SQ' && charValue['Character'] != 'Accessory'}">{!charValue['Price']}</apex:outputPanel>
                                        </td>
                                        <td>
                                            <apex:outputPanel rendered="{!charValue['Character'] != 'SQ' && charValue['Character'] != 'Accessory'}">{!charValue['cvTotal']}</apex:outputPanel>
                                        </td>
                                    </tr>
                                <!-- </apex:outputPanel> -->
                            
                        </apex:repeat>
                    </tbody>
                    <tfoot>
                     <tr class="colored">
                        <td colspan="5">Total Price</td>
                        <td>{!item['AllExtPrice']}</td>
                     </tr>
                     <tr>
                        <td colspan="5">DC FROM DN Solutions ({!item['DCPercent']} %)</td>
                        <td style="color: red;">{!item['DCPrice']}</td>
                     </tr>
                     <tr class="colored">
                        <td colspan="5">Total Net Price</td>
                        <td>{!item['NetPrice']}</td>
                     </tr>
                     <tr>
                        <td colspan="5">Adjustment Price</td>
                        <td>{!item['Adjustment']}</td>
                     </tr>
                     <tr class="colored">
                        <td colspan="5">Total Net Price + Adjustment Price</td>
                        <td>{!item['NetAddAdj']}</td>

                     </tr>
                     <tr>
                        <td colspan="5">Warranty ({!item['Warranty']})</td>
                        <td>{!item['WarrantyPrice']}</td>
                     </tr>
                     <tr class="colored">
                        <td colspan="5">Final Price</td>
                        <td>{!item['FinalPrice']}</td>
                     </tr>
                    </tfoot>
                </table>
            </div>

            <dl>
               <dt>Comment :</dt>
               <dd>- Delivery from Korea: {!item['leadTime']} months after confirmed order</dd>
               <dd>- Delivery date: discussed after contract completion</dd>
               <dd>- Quotation validity period: 1 month from submission date</dd>
            </dl>
        <!-- 페이지 브레이크 및 점선 추가 -->
        <apex:outputPanel rendered="{!NOT(item['IsLast'])}">
            <div class="page-break-line"></div>
            <div style="page-break-before: always;"></div>
        </apex:outputPanel>
    </apex:repeat>
</body>
    </html>
</apex:page>