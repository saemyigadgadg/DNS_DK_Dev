/**
 * @author            : Se-Jin Kwon
 * @description       : 
 *  - CloseDate의 잔여일이 3,2,1,0일 일 때 Noti
 *  - CloseDate가 오늘날짜 기준 -1일이면 Closed Drop처리
 * @last modified on  : 2025-03-25
 * Modifications Log
 * Ver   Date         Author                      Modification
 * 1.0   2025-03-25   SEJIN KWON                 Initial Version
**/

public with sharing class DN_OpportunityClosedDateAlertBatch implements Database.Batchable<sObject>, Schedulable, Database.Stateful{
    private class OpportunityNotification {
        public Id opportunityId { get; set; }
        public Id ownerId { get; set; }
        public Decimal duration { get; set; }
        public String Email { get; set; }
        public String lang { get; set; }
        public String license { get; set; }
        public String accName { get; set; }
        public String opptyName { get; set; }
        public String managerName { get; set; }
        public String managerEmail { get; set; }

        // 생성자
        public OpportunityNotification(Id opportunityId, Id ownerId, Decimal duration, String Email, String lang, String license, String accName, String opptyName, String managerName, String managerEmail) {
            this.opportunityId = opportunityId;
            this.ownerId = ownerId;
            this.duration = duration;
            this.Email = Email;
            this.lang = lang;
            this.license = license;
            this.accName = accName;
            this.opptyName = opptyName;
            this.managerName = managerName;
            this.managerEmail = managerEmail;
        }
    }

    public Database.QueryLocator start(Database.BatchableContext bc) {
        return Database.getQueryLocator([
            SELECT
                Id,
                Name,
                StageName,
                DiffClosedDate__c,
                Account.Name,

                OpportunityIdentifier__c,
                OpportunityIdentifier__r.Email,
                OpportunityIdentifier__r.LanguageLocaleKey,
                OpportunityIdentifier__r.Profile.UserLicense.Name,
                OpportunityIdentifier__r.Manager.Name,
                OpportunityIdentifier__r.Manager.Email,

                Opportunity_Owner__c,
                Opportunity_Owner__r.Email,
                Opportunity_Owner__r.LanguageLocaleKey,
                Opportunity_Owner__r.Profile.UserLicense.Name,
                Opportunity_Owner__r.Manager.Name,
                Opportunity_Owner__r.Manager.Email
            FROM
                Opportunity
            WHERE
                StageName NOT IN ('Closed Won', 'Closed Drop', 'Closed Lost')
            AND OpportunityIdentifier__c != null 
            AND RecordType.Name IN ('General','Turn-Key (AE)')
            // AND Opportunity_Owner__r.Email	 like '%sejin.kwon%'
            AND DiffClosedDate__c IN (7,3,2,1,0)
        ]);
    }

    public void execute(Database.BatchableContext bc, List<Opportunity> scope){

        List<Opportunity> closedOpty =
        [
            SELECT
                Id
            FROM
                Opportunity
            WHERE
                StageName NOT IN ('Closed Won', 'Closed Drop', 'Closed Lost')
            AND OpportunityIdentifier__c != null 
            AND RecordType.Name IN ('General','Turn-Key (AE)')
            AND DiffClosedDate__c = -1
        ];
        List<Opportunity> CloseOptyList = new List<Opportunity>();
        if(!closedOpty.isEmpty()){
            for(Opportunity opty : closedOpty){
                Opportunity closed = new Opportunity();
                closed.Id = opty.Id;
                closed.StageName = 'Closed Drop';
                closed.Reason_Mis__c = 'Expiration of sales validity period';
                closed.Loss_Reason__c = '1. Expiration of sales validity period';
                CloseOptyList.add(closed);
            }
            update CloseOptyList;
            
        }

        List<Opportunity> notiOppty = new List<Opportunity>();
        Set<Id> setownerId = new Set<Id>();
        List<OpportunityNotification> notifications = new List<OpportunityNotification>();

        for(Opportunity opp : scope){
            Id ownerIdcheck =  opp.Opportunity_Owner__c != null ? opp.Opportunity_Owner__c : opp.OpportunityIdentifier__c;
            String ownerEmail = opp.Opportunity_Owner__r.Email != null ? opp.Opportunity_Owner__r.Email : opp.OpportunityIdentifier__r.Email;
            String ownerLang = opp.Opportunity_Owner__r.LanguageLocaleKey != null ? opp.Opportunity_Owner__r.LanguageLocaleKey : opp.OpportunityIdentifier__r.LanguageLocaleKey;
            String ownerLicense = opp.Opportunity_Owner__r.Profile.UserLicense.Name != null ? opp.Opportunity_Owner__r.Profile.UserLicense.Name : opp.OpportunityIdentifier__r.Profile.UserLicense.Name;
            String owernerManagerName = opp.Opportunity_Owner__r.Manager.Name != null ? opp.Opportunity_Owner__r.Manager.Name : opp.OpportunityIdentifier__r.Manager.Name;
            String owernerManagerEmail = opp.Opportunity_Owner__r.Manager.Email != null ? opp.Opportunity_Owner__r.Manager.Email : opp.OpportunityIdentifier__r.Manager.Email;
            
            // notifications.add(new OpportunityNotification(  opp.Id, 
            //                                                 opp.Opportunity_Owner__c, 
            //                                                 opp.DiffClosedDate__c, 
            //                                                 opp.Opportunity_Owner__r.Email,
            //                                                 opp.Opportunity_Owner__r.LanguageLocaleKey,
            //                                                 opp.Opportunity_Owner__r.Profile.UserLicense.Name,
            //                                                 opp.Account.Name,
            //                                                 opp.Name,
            //                                                 opp.Opportunity_Owner__r.Manager.Name,
            //                                                 opp.Opportunity_Owner__r.Manager.Email
            //                                             ));
            notifications.add(new OpportunityNotification(  opp.Id, 
                                                            ownerIdcheck, 
                                                            opp.DiffClosedDate__c, 
                                                            ownerEmail,
                                                            ownerLang,
                                                            ownerLicense,
                                                            opp.Account.Name,
                                                            opp.Name,
                                                            owernerManagerName,
                                                            owernerManagerEmail
                                                        ));
        }

        for(OpportunityNotification ownerId : notifications){
            setownerId.add(ownerId.ownerId);
        }

        List<Network> portal = [SELECT Id, Name FROM Network WHERE Name = 'Partners'];
        List<UTIL_Alert.HistoryWrapper> totalEmail = new List<UTIL_Alert.HistoryWrapper>();

        for(String ownerId : setownerId){
            String message = '';
            String Email = '';
            String managerEmail = '';
            String lang = '';
            Integer totalCount = 0;
            for(OpportunityNotification setoppNoti : notifications){
                if(setoppNoti.ownerId == ownerId){
                    String baseUrl;
                    String recordLink;

                    if(setoppNoti.license != null && setoppNoti.license.contains('Partner Community')){
                        baseUrl = Network.getLoginUrl(portal[0].Id).removeEnd('/s/login');
                        recordLink = baseUrl + '/' + setoppNoti.opportunityId;
                    }else{
                        baseUrl = URL.getOrgDomainUrl().toExternalForm();
                        recordLink = baseUrl + '/' + setoppNoti.opportunityId;
                    }
    
                    String instanceUrl = recordLink;
                    if(setoppNoti.lang == 'ko'){
                        message += 
                        + '고객사 : ' + setoppNoti.accName + '<br>' 
                        + '영업기회 : ' + setoppNoti.opptyName + '<br>' 
                        + '잔여일수 : ' + setoppNoti.duration + '<br>'
                        + '링크 : ' + instanceUrl + '<br><br>';
                    }else if(setoppNoti.lang == 'en_US'){
                        message += 
                        + 'Account : ' + setoppNoti.accName + '<br>' 
                        + 'Opportunity : ' + setoppNoti.opptyName + '<br>' 
                        + 'Duration : ' + setoppNoti.duration + '<br>'
                        + 'Link : ' + instanceUrl + '<br><br>';
                    }else{
                        message += 
                        + '고객사 : ' + setoppNoti.accName + '<br>' 
                        + '영업기회 : ' + setoppNoti.opptyName + '<br>' 
                        + '초과일수 : ' + setoppNoti.duration + '<br>'
                        + '링크 : ' + instanceUrl + '<br><br>';
                    }
                    Email = setoppNoti.Email;
                    lang = setoppNoti.lang;
                    totalCount++;
                    if(setoppNoti.managerName != null && setoppNoti.managerName.contains('우상철')){
                        managerEmail = setoppNoti.managerEmail;
                    }
                }
            }
            List<AlertManager__c> am = [SELECT Id FROM AlertManager__c WHERE Name = 'Opportunity Closed Date Email Alert'];
            Id alertId;
    
            if(!am.isEmpty()){
                alertId = am[0].Id;
            }else{
                alertId = 'a0xJO000000Ae4DYAS';
            }
            UTIL_Alert.HistoryWrapper wrapEmail = new UTIL_Alert.HistoryWrapper();
            wrapEmail.alertID            = alertId;
            // wrapEmail.targetID           = oppNoti.opportunityId;
            wrapEmail.alertType          = 'Email';
            if(managerEmail == null || managerEmail == ''){
                wrapEmail.receiverforEmail   = new List<String>{Email};
            }else{
                wrapEmail.receiverforEmail   = new List<String>{Email, managerEmail};
            }
            wrapEmail.elementList        = new List<String>{message, String.valueOf(totalCount)};
            if(lang == 'ko'){
                wrapEmail.title              = '영업기회 종료 예정 임박 알림';
                wrapEmail.alertLanguage      = 'ko';
            }else if(lang == 'en_US'){
                wrapEmail.title              = 'Opportunity Close Date Reminder';
                wrapEmail.alertLanguage      = 'en';
            }else{
                wrapEmail.title              = '영업기회 종료 예정 임박 알림';
                wrapEmail.alertLanguage      = 'ko';
    
            }
            totalEmail.add(wrapEmail);  
        }

        System.debug('size : ' + totalEmail.size());
        UTIL_Alert.runAlertEvent(totalEmail);
    }

    public void finish(Database.BatchableContext bc){
        System.debug('DN_OpportunityClosedDateAlertBatch completed :: ' + System.now());
    }

    public void execute(SchedulableContext sc) {
        DN_OpportunityClosedDateAlertBatch batch = new DN_OpportunityClosedDateAlertBatch();
        Database.executeBatch(batch);
    }
    public static void dummy() {
        Integer i = 0;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
                i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
        i++;
    }
}